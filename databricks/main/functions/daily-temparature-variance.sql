-- Databricks notebook source
-- MAGIC %sql
-- MAGIC CREATE OR REPLACE TEMP VIEW DAILY_TEMPARATURE_VARIANCE AS
-- MAGIC WITH STATION_DAILY_TEMPARATURES AS 
-- MAGIC  (SELECT NAME, STATION, DATE, AVG_TEMP_F FROM STATION_DATA ORDER BY STATION, DATE)
-- MAGIC 
-- MAGIC SELECT NAME, STATION, DATE, AVG_TEMP_F, 
-- MAGIC ROUND(LEAD(AVG_TEMP_F) OVER (PARTITION BY STATION ORDER BY DATE) - AVG_TEMP_F , 1)
-- MAGIC 		AS DAILY_VARIANCE
-- MAGIC 
-- MAGIC FROM STATION_DAILY_TEMPARATURES